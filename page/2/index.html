<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.4.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="记录点点滴滴">
<meta property="og:type" content="website">
<meta property="og:title" content="jefby的小窝">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="jefby的小窝">
<meta property="og:description" content="记录点点滴滴">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="jefby的小窝">
<meta name="twitter:description" content="记录点点滴滴">






  <link rel="canonical" href="http://yoursite.com/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>jefby的小窝</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jefby的小窝</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/11/30/ARM64从源码编译docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/30/ARM64从源码编译docker/" itemprop="url">
                  ARM64从源码编译docker（v1.9.1) 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2015-11-30 20:41:11" itemprop="dateCreated datePublished" datetime="2015-11-30T20:41:11+08:00">2015-11-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/aarch64/" itemprop="url" rel="index"><span itemprop="name">aarch64</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/11/30/ARM64从源码编译docker/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/11/30/ARM64从源码编译docker/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>在X86_64机器fedora系统下，不要使用官方编译的rpm包，交叉编译bootstrap会出现异常，使用源码编译的go.</p>
</blockquote>
<h3 id="1-编译X86-64的go-binary"><a href="#1-编译X86-64的go-binary" class="headerlink" title="1.编译X86_64的go binary"></a>1.编译X86_64的go binary</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /root</span><br><span class="line">git clone https://github.com/golang/go</span><br><span class="line">git checkout go1.4.2</span><br><span class="line">cd src/</span><br><span class="line">./make.bash //先编译一个go x86_64</span><br><span class="line">mv /root/go /root/go1.4//因为go1.5beta代码固定了go路径</span><br></pre></td></tr></table></figure>
<h3 id="2-下载go1-5-1，使用go1-4为arm64交叉编译bootstrap，或者直接checkout-go1-5-1"><a href="#2-下载go1-5-1，使用go1-4为arm64交叉编译bootstrap，或者直接checkout-go1-5-1" class="headerlink" title="2.下载go1.5.1，使用go1.4为arm64交叉编译bootstrap，或者直接checkout go1.5.1"></a>2.下载go1.5.1，使用go1.4为arm64交叉编译bootstrap，或者直接checkout go1.5.1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd go/src/</span><br><span class="line">GOOS=linux GOARCH=arm64 ./bootstrap.bash</span><br></pre></td></tr></table></figure>
<h3 id="3-拷贝go-linux-arm64-bootstrap-tbz到Arm64机器上继续编译其他模块"><a href="#3-拷贝go-linux-arm64-bootstrap-tbz到Arm64机器上继续编译其他模块" class="headerlink" title="3. 拷贝go-linux-arm64-bootstrap.tbz到Arm64机器上继续编译其他模块"></a>3. 拷贝go-linux-arm64-bootstrap.tbz到Arm64机器上继续编译其他模块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scp go-linux-arm64-bootstrap.tbz xxx //</span><br><span class="line">//下载go1.5.1代码</span><br><span class="line">git checkout go1.5.1</span><br><span class="line">cd go/src</span><br><span class="line">GOROOT=/path/to/go/bootstrap</span><br><span class="line">GOROOT_BOOTSTRAP=$GOROOT ./all.bash</span><br></pre></td></tr></table></figure>
<h3 id="4-下载docker源码并编译"><a href="#4-下载docker源码并编译" class="headerlink" title="4. 下载docker源码并编译"></a>4. 下载docker源码并编译</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/jefby/docker.git</span><br><span class="line">git checkout jefby-v1.9.1 //找到最新的v1.9.1版本</span><br><span class="line">AUTO_GOPATH=1 ./hack/make.sh dynbinary //编译动态版本</span><br><span class="line">./hack/make.sh binary //静态版本，根据github docker社区的评论，似乎是用Redhat系列不能用静态版本的，因为默认使用了devicemapper，而不是ubuntu使用的aufs</span><br></pre></td></tr></table></figure>
<h3 id="5-需要安装glibc-static"><a href="#5-需要安装glibc-static" class="headerlink" title="5. 需要安装glibc-static"></a>5. 需要安装glibc-static</h3><p>在docker v1.9.1版本中，hack/make.sh dynbinary中依然依赖libc.a和libpthread.a库，所以需要安装glibc-static rpm包，提供这两个库~</p>
<h3 id="6-修改hack-make-sh增加set-x"><a href="#6-修改hack-make-sh增加set-x" class="headerlink" title="6. 修改hack/make.sh增加set -x"></a>6. 修改hack/make.sh增加set -x</h3><p>添加调试选项，进行debug，查看到底是什么地方出现错误</p>
<h3 id="7-安装必须的一些pkg"><a href="#7-安装必须的一些pkg" class="headerlink" title="7.安装必须的一些pkg"></a>7.安装必须的一些pkg</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y device-mapper-devel</span><br><span class="line">yum install -y btrfs-progs-devel</span><br></pre></td></tr></table></figure>
<h3 id="8-docker-pull-的时候提示错误Server-error-Status-0-while-fetching-image-layer"><a href="#8-docker-pull-的时候提示错误Server-error-Status-0-while-fetching-image-layer" class="headerlink" title="8.docker pull 的时候提示错误Server error: Status 0 while fetching image layer"></a>8.docker pull 的时候提示错误Server error: Status 0 while fetching image layer</h3><p>解决方法：<br>在/etc/hosts后面添加对docker网站的dns解析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">162.242.195.84 index.docker.io</span><br><span class="line">162.242.195.84 registry-1.docker.io</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/11/06/Applied-Micro-Mustang-支持kvm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/06/Applied-Micro-Mustang-支持kvm/" itemprop="url">
                  Applied Micro Mustang 支持kvm 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2015-11-06 20:16:39" itemprop="dateCreated datePublished" datetime="2015-11-06T20:16:39+08:00">2015-11-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/aarch64/" itemprop="url" rel="index"><span itemprop="name">aarch64</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/11/06/Applied-Micro-Mustang-支持kvm/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/11/06/Applied-Micro-Mustang-支持kvm/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在mustang机器上安装了Centos7，并升级内核到4.1.0-0.rc2</p>
<p><img src="http://img.blog.csdn.net/20151106195956322" alt="kernel-version"></p>
<p>但是dmesg发现并不支持kvm，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[    0.343796] kvm [1]: GICV size 0x2000 not a multiple of page size 0x10000</span><br><span class="line">[    0.343802] kvm [1]: error: no compatible GIC info found</span><br><span class="line">[    0.343909] kvm [1]: error initializing Hyp mode: -6</span><br></pre></td></tr></table></figure></p>
<p>在这里有相关的patch，<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1165290" target="_blank" rel="noopener">https://bugzilla.redhat.com/show_bug.cgi?id=1165290</a> ，但是打上补丁后虽然能够解决掉kvm的bug，但是又引入了新的问题，ethernet1和eth2识别不了，因为新的内核解析的时候需要增加对应的interrupt reg</p>
<p><img src="http://img.blog.csdn.net/20151106200426852" alt="patch"></p>
<p>按照如下修改后即可，好用的mustang.dts如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br></pre></td><td class="code"><pre><span class="line">/dts-v1/;</span><br><span class="line"></span><br><span class="line">/ &#123;</span><br><span class="line">	model = &quot;APM X-Gene Mustang board&quot;;</span><br><span class="line">	compatible = &quot;apm,mustang&quot;, &quot;apm,xgene-storm&quot;;</span><br><span class="line">	#address-cells = &lt;0x2&gt;;</span><br><span class="line">	#size-cells = &lt;0x2&gt;;</span><br><span class="line">	interrupt-parent = &lt;0x1&gt;;</span><br><span class="line"></span><br><span class="line">	pmu &#123;</span><br><span class="line">		interrupts = &lt;0x1 0xc 0xff04&gt;;</span><br><span class="line">		compatible = &quot;arm,armv8-pmuv3&quot;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	soc &#123;</span><br><span class="line">		compatible = &quot;simple-bus&quot;;</span><br><span class="line">		ranges;</span><br><span class="line">		#address-cells = &lt;0x2&gt;;</span><br><span class="line">		#size-cells = &lt;0x2&gt;;</span><br><span class="line"></span><br><span class="line">		sata@1a800000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1a800000 0x0 0x1000 0x0 0x1f230000 0x0 0x1000 0x0 0x1f23d000 0x0 0x1000 0x0 0x1f23e000 0x0 0x1000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x88 0x4&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-ahci&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		serial@1c020000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1c020000 0x0 0x1000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x4c 0x4&gt;;</span><br><span class="line">			reg-shift = &lt;0x2&gt;;</span><br><span class="line">			compatible = &quot;ns16550a&quot;;</span><br><span class="line">			clock-frequency = &lt;0x2faf080&gt;;</span><br><span class="line">			device_type = &quot;serial&quot;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			interrupt-parent = &lt;0x1&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		serial@1c021000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1c021000 0x0 0x1000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x4d 0x4&gt;;</span><br><span class="line">			reg-shift = &lt;0x2&gt;;</span><br><span class="line">			compatible = &quot;ns16550a&quot;;</span><br><span class="line">			clock-frequency = &lt;0x2faf080&gt;;</span><br><span class="line">			device_type = &quot;serial&quot;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">			interrupt-parent = &lt;0x1&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		serial@1c022000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1c022000 0x0 0x1000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x4e 0x4&gt;;</span><br><span class="line">			reg-shift = &lt;0x2&gt;;</span><br><span class="line">			compatible = &quot;ns16550a&quot;;</span><br><span class="line">			clock-frequency = &lt;0x2faf080&gt;;</span><br><span class="line">			device_type = &quot;serial&quot;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">			interrupt-parent = &lt;0x1&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		serial@1c023000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1c023000 0x0 0x1000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x4f 0x4&gt;;</span><br><span class="line">			reg-shift = &lt;0x2&gt;;</span><br><span class="line">			compatible = &quot;ns16550a&quot;;</span><br><span class="line">			clock-frequency = &lt;0x2faf080&gt;;</span><br><span class="line">			device_type = &quot;serial&quot;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">			interrupt-parent = &lt;0x1&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		pcie@1f500000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f500000 0x0 0x10000 0xa0 0xd0000000 0x0 0x200000&gt;;</span><br><span class="line">			reg-names = &quot;csr&quot;, &quot;cfg&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene-storm-pcie&quot;, &quot;apm,xgene-pcie&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			device_type = &quot;pci&quot;;</span><br><span class="line">			clocks = &lt;0x9 0x0&gt;;</span><br><span class="line">			#interrupt-cells = &lt;0x1&gt;;</span><br><span class="line">			dma-ranges = &lt;0x42000000 0x80 0x0 0x80 0x0 0x0 0x80000000 0x42000000 0x0 0x0 0x0 0x0 0x80 0x0&gt;;</span><br><span class="line">			ranges = &lt;0x1000000 0x0 0x0 0xa0 0x10000000 0x0 0x10000 0x2000000 0x0 0x80000000 0xa1 0x80000000 0x0 0x80000000&gt;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">			#address-cells = &lt;0x3&gt;;</span><br><span class="line">			interrupt-map = &lt;0x0 0x0 0x0 0x1 0x1 0x0 0xd4 0x1 0x0 0x0 0x0 0x2 0x1 0x0 0xd5 0x1 0x0 0x0 0x0 0x3 0x1 0x0 0xd6 0x1 0x0 0x0 0x0 0x4 0x1 0x0 0xd7 0x1&gt;;</span><br><span class="line">			interrupt-map-mask = &lt;0x0 0x0 0x0 0x7&gt;;</span><br><span class="line">			#size-cells = &lt;0x2&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		pcie@1f510000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f510000 0x0 0x10000 0xc0 0xd0000000 0x0 0x200000&gt;;</span><br><span class="line">			reg-names = &quot;csr&quot;, &quot;cfg&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene-storm-pcie&quot;, &quot;apm,xgene-pcie&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			device_type = &quot;pci&quot;;</span><br><span class="line">			clocks = &lt;0xa 0x0&gt;;</span><br><span class="line">			#interrupt-cells = &lt;0x1&gt;;</span><br><span class="line">			dma-ranges = &lt;0x42000000 0x80 0x0 0x80 0x0 0x0 0x80000000 0x42000000 0x0 0x0 0x0 0x0 0x80 0x0&gt;;</span><br><span class="line">			ranges = &lt;0x1000000 0x0 0x0 0xc0 0x10000000 0x0 0x10000 0x2000000 0x0 0x80000000 0xc1 0x80000000 0x0 0x80000000&gt;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">			#address-cells = &lt;0x3&gt;;</span><br><span class="line">			interrupt-map = &lt;0x0 0x0 0x0 0x1 0x1 0x0 0xda 0x1 0x0 0x0 0x0 0x2 0x1 0x0 0xdb 0x1 0x0 0x0 0x0 0x3 0x1 0x0 0xdc 0x1 0x0 0x0 0x0 0x4 0x1 0x0 0xdd 0x1&gt;;</span><br><span class="line">			interrupt-map-mask = &lt;0x0 0x0 0x0 0x7&gt;;</span><br><span class="line">			#size-cells = &lt;0x2&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		pcie@1f2b0000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f2b0000 0x0 0x10000 0xe0 0xd0000000 0x0 0x200000&gt;;</span><br><span class="line">			reg-names = &quot;csr&quot;, &quot;cfg&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene-storm-pcie&quot;, &quot;apm,xgene-pcie&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			device_type = &quot;pci&quot;;</span><br><span class="line">			clocks = &lt;0x6 0x0&gt;;</span><br><span class="line">			#interrupt-cells = &lt;0x1&gt;;</span><br><span class="line">			dma-ranges = &lt;0x42000000 0x80 0x0 0x80 0x0 0x0 0x80000000 0x42000000 0x0 0x0 0x0 0x0 0x80 0x0&gt;;</span><br><span class="line">			ranges = &lt;0x1000000 0x0 0x0 0xe0 0x10000000 0x0 0x10000 0x2000000 0x0 0x80000000 0xe1 0x80000000 0x0 0x80000000&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			#address-cells = &lt;0x3&gt;;</span><br><span class="line">			interrupt-map = &lt;0x0 0x0 0x0 0x1 0x1 0x0 0xc2 0x1 0x0 0x0 0x0 0x2 0x1 0x0 0xc3 0x1 0x0 0x0 0x0 0x3 0x1 0x0 0xc4 0x1 0x0 0x0 0x0 0x4 0x1 0x0 0xc5 0x1&gt;;</span><br><span class="line">			interrupt-map-mask = &lt;0x0 0x0 0x0 0x7&gt;;</span><br><span class="line">			#size-cells = &lt;0x2&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		pcie@1f2c0000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f2c0000 0x0 0x10000 0xd0 0xd0000000 0x0 0x200000&gt;;</span><br><span class="line">			reg-names = &quot;csr&quot;, &quot;cfg&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene-storm-pcie&quot;, &quot;apm,xgene-pcie&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			device_type = &quot;pci&quot;;</span><br><span class="line">			clocks = &lt;0x7 0x0&gt;;</span><br><span class="line">			#interrupt-cells = &lt;0x1&gt;;</span><br><span class="line">			dma-ranges = &lt;0x42000000 0x80 0x0 0x80 0x0 0x0 0x80000000 0x42000000 0x0 0x0 0x0 0x0 0x80 0x0&gt;;</span><br><span class="line">			ranges = &lt;0x1000000 0x0 0x0 0xd0 0x10000000 0x0 0x10000 0x2000000 0x0 0x80000000 0xd1 0x80000000 0x0 0x80000000&gt;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">			#address-cells = &lt;0x3&gt;;</span><br><span class="line">			interrupt-map = &lt;0x0 0x0 0x0 0x1 0x1 0x0 0xc8 0x1 0x0 0x0 0x0 0x2 0x1 0x0 0xc9 0x1 0x0 0x0 0x0 0x3 0x1 0x0 0xca 0x1 0x0 0x0 0x0 0x4 0x1 0x0 0xcb 0x1&gt;;</span><br><span class="line">			interrupt-map-mask = &lt;0x0 0x0 0x0 0x7&gt;;</span><br><span class="line">			#size-cells = &lt;0x2&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		pcie@1f2d0000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f2d0000 0x0 0x10000 0x90 0xd0000000 0x0 0x200000&gt;;</span><br><span class="line">			reg-names = &quot;csr&quot;, &quot;cfg&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene-storm-pcie&quot;, &quot;apm,xgene-pcie&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			device_type = &quot;pci&quot;;</span><br><span class="line">			clocks = &lt;0x8 0x0&gt;;</span><br><span class="line">			#interrupt-cells = &lt;0x1&gt;;</span><br><span class="line">			dma-ranges = &lt;0x42000000 0x80 0x0 0x80 0x0 0x0 0x80000000 0x42000000 0x0 0x0 0x0 0x0 0x80 0x0&gt;;</span><br><span class="line">			ranges = &lt;0x1000000 0x0 0x0 0x90 0x10000000 0x0 0x10000 0x2000000 0x0 0x80000000 0x91 0x80000000 0x0 0x80000000&gt;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">			#address-cells = &lt;0x3&gt;;</span><br><span class="line">			interrupt-map = &lt;0x0 0x0 0x0 0x1 0x1 0x0 0xce 0x1 0x0 0x0 0x0 0x2 0x1 0x0 0xcf 0x1 0x0 0x0 0x0 0x3 0x1 0x0 0xd0 0x1 0x0 0x0 0x0 0x4 0x1 0x0 0xd1 0x1&gt;;</span><br><span class="line">			interrupt-map-mask = &lt;0x0 0x0 0x0 0x7&gt;;</span><br><span class="line">			#size-cells = &lt;0x2&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		ethernet_old@17020000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x17020000 0x0 0x30 0x0 0x17020000 0x0 0x10000 0x0 0x17020000 0x0 0x20&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x38 0x4 0x0 0x39 0x4 0x0 0x3a 0x4&gt;;</span><br><span class="line">			#clock-cells = &lt;0x1&gt;;</span><br><span class="line">			devid = &lt;0x8&gt;;</span><br><span class="line">			phyid = &lt;0x3&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-enet-old&quot;;</span><br><span class="line">			local-mac-address = [00 01 73 02 0b 73];</span><br><span class="line">			slave-name = &quot;RGMII&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			phy-mode = &quot;rgmii&quot;;</span><br><span class="line">			clocks = &lt;0x15 0x0&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			max-frame-size = &lt;0x233a&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		dwusb@19000000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x19000000 0x0 0x100000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x89 0x4&gt;;</span><br><span class="line">			compatible = &quot;xhci-platform&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		phy@1f21a000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f21a000 0x0 0x100&gt;;</span><br><span class="line">			apm,tx-eye-tuning = &lt;0x2 0xa 0xa 0x2 0xa 0xa&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-phy&quot;;</span><br><span class="line">			#phy-cells = &lt;0x1&gt;;</span><br><span class="line">			clocks = &lt;0xb 0x0&gt;;</span><br><span class="line">			apm,tx-boost-gain = &lt;0x2 0x3 0x3 0x2 0x3 0x3&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			phandle = &lt;0xf&gt;;</span><br><span class="line">			linux,phandle = &lt;0xf&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		phy@1f22a000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f22a000 0x0 0x100&gt;;</span><br><span class="line">			apm,tx-eye-tuning = &lt;0x1 0xa 0xa 0x2 0xa 0xa&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-phy&quot;;</span><br><span class="line">			#phy-cells = &lt;0x1&gt;;</span><br><span class="line">			apm,tx-boost-gain = &lt;0x1e 0x1e 0x1e 0x1e 0x1e 0x1e&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			phandle = &lt;0x11&gt;;</span><br><span class="line">			linux,phandle = &lt;0x11&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		phy@1f23a000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f23a000 0x0 0x100&gt;;</span><br><span class="line">			apm,tx-eye-tuning = &lt;0x2 0xa 0xa 0x2 0xa 0xa&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-phy&quot;;</span><br><span class="line">			#phy-cells = &lt;0x1&gt;;</span><br><span class="line">			apm,tx-boost-gain = &lt;0x1f 0x1f 0x1f 0x1f 0x1f 0x1f&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			phandle = &lt;0x13&gt;;</span><br><span class="line">			linux,phandle = &lt;0x13&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		system-clk-controller@17000000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x17000000 0x0 0x400&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-scu&quot;, &quot;syscon&quot;;</span><br><span class="line">			phandle = &lt;0x16&gt;;</span><br><span class="line">			linux,phandle = &lt;0x16&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		dwusb@19800000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x19800000 0x0 0x100000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x8a 0x4&gt;;</span><br><span class="line">			compatible = &quot;xhci-platform&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		clocks &#123;</span><br><span class="line">			ranges;</span><br><span class="line">			#address-cells = &lt;0x2&gt;;</span><br><span class="line">			#size-cells = &lt;0x2&gt;;</span><br><span class="line"></span><br><span class="line">			pcie1clk@1f2cc000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f2cc000 0x0 0x1000&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;pcie1clk&quot;;</span><br><span class="line">				status = &quot;disabled&quot;;</span><br><span class="line">				phandle = &lt;0x7&gt;;</span><br><span class="line">				linux,phandle = &lt;0x7&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			pcie2clk@1f2dc000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f2dc000 0x0 0x1000&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;pcie2clk&quot;;</span><br><span class="line">				status = &quot;disabled&quot;;</span><br><span class="line">				phandle = &lt;0x8&gt;;</span><br><span class="line">				linux,phandle = &lt;0x8&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			xge0clk@1f61c000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f61c000 0x0 0x1000&gt;;</span><br><span class="line">				csr-mask = &lt;0x3&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;xge0clk&quot;;</span><br><span class="line">				phandle = &lt;0x19&gt;;</span><br><span class="line">				linux,phandle = &lt;0x19&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			sataphy1clk@1f21c000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f21c000 0x0 0x1000&gt;;</span><br><span class="line">				csr-offset = &lt;0x4&gt;;</span><br><span class="line">				csr-mask = &lt;0x0&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				enable-offset = &lt;0x0&gt;;</span><br><span class="line">				enable-mask = &lt;0x6&gt;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;sataphy1clk&quot;;</span><br><span class="line">				status = &quot;disabled&quot;;</span><br><span class="line">				phandle = &lt;0xb&gt;;</span><br><span class="line">				linux,phandle = &lt;0xb&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			socplldiv2 &#123;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				compatible = &quot;fixed-factor-clock&quot;;</span><br><span class="line">				clock-names = &quot;socplldiv2&quot;;</span><br><span class="line">				clocks = &lt;0x3 0x0&gt;;</span><br><span class="line">				clock-div = &lt;0x2&gt;;</span><br><span class="line">				clock-output-names = &quot;socplldiv2&quot;;</span><br><span class="line">				phandle = &lt;0x4&gt;;</span><br><span class="line">				clock-mult = &lt;0x1&gt;;</span><br><span class="line">				linux,phandle = &lt;0x4&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			rngpkaclk@17000000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x17000000 0x0 0x2000&gt;;</span><br><span class="line">				csr-offset = &lt;0xc&gt;;</span><br><span class="line">				csr-mask = &lt;0x10&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				enable-offset = &lt;0x10&gt;;</span><br><span class="line">				enable-mask = &lt;0x10&gt;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;rngpkaclk&quot;;</span><br><span class="line">				phandle = &lt;0x1a&gt;;</span><br><span class="line">				linux,phandle = &lt;0x1a&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			sge0clk@1f21c000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f21c000 0x0 0x1000&gt;;</span><br><span class="line">				csr-mask = &lt;0x3&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;sge0clk&quot;;</span><br><span class="line">				phandle = &lt;0x18&gt;;</span><br><span class="line">				linux,phandle = &lt;0x18&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			pcie3clk@1f50c000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f50c000 0x0 0x1000&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;pcie3clk&quot;;</span><br><span class="line">				status = &quot;disabled&quot;;</span><br><span class="line">				phandle = &lt;0x9&gt;;</span><br><span class="line">				linux,phandle = &lt;0x9&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			ethclk &#123;</span><br><span class="line">				reg = &lt;0x0 0x17000000 0x0 0x1000&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;div-reg&quot;;</span><br><span class="line">				divider-shift = &lt;0x0&gt;;</span><br><span class="line">				divider-width = &lt;0x9&gt;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clock-names = &quot;ethclk&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;ethclk&quot;;</span><br><span class="line">				divider-offset = &lt;0x238&gt;;</span><br><span class="line">				phandle = &lt;0x5&gt;;</span><br><span class="line">				linux,phandle = &lt;0x5&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			pcppll@17000100 &#123;</span><br><span class="line">				reg = &lt;0x0 0x17000100 0x0 0x1000&gt;;</span><br><span class="line">				type = &lt;0x0&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				compatible = &quot;apm,xgene-pcppll-clock&quot;;</span><br><span class="line">				clock-names = &quot;pcppll&quot;;</span><br><span class="line">				clocks = &lt;0x2 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;pcppll&quot;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			qmlclk &#123;</span><br><span class="line">				reg = &lt;0x0 0x1703c000 0x0 0x1000&gt;;</span><br><span class="line">				csr-offset = &lt;0x0&gt;;</span><br><span class="line">				csr-mask = &lt;0x3&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clock-names = &quot;qmlclk&quot;;</span><br><span class="line">				enable-offset = &lt;0x8&gt;;</span><br><span class="line">				enable-mask = &lt;0x3&gt;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;qmlclk&quot;;</span><br><span class="line">				status = &quot;ok&quot;;</span><br><span class="line">				phandle = &lt;0x14&gt;;</span><br><span class="line">				linux,phandle = &lt;0x14&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			refclk &#123;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				compatible = &quot;fixed-clock&quot;;</span><br><span class="line">				clock-frequency = &lt;0x5f5e100&gt;;</span><br><span class="line">				clock-output-names = &quot;refclk&quot;;</span><br><span class="line">				phandle = &lt;0x2&gt;;</span><br><span class="line">				linux,phandle = &lt;0x2&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			pcie4clk@1f51c000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f51c000 0x0 0x1000&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;pcie4clk&quot;;</span><br><span class="line">				status = &quot;disabled&quot;;</span><br><span class="line">				phandle = &lt;0xa&gt;;</span><br><span class="line">				linux,phandle = &lt;0xa&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			pcie0clk@1f2bc000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f2bc000 0x0 0x1000&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;pcie0clk&quot;;</span><br><span class="line">				status = &quot;ok&quot;;</span><br><span class="line">				phandle = &lt;0x6&gt;;</span><br><span class="line">				linux,phandle = &lt;0x6&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			socpll@17000120 &#123;</span><br><span class="line">				reg = &lt;0x0 0x17000120 0x0 0x1000&gt;;</span><br><span class="line">				type = &lt;0x1&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				compatible = &quot;apm,xgene-socpll-clock&quot;;</span><br><span class="line">				clock-names = &quot;socpll&quot;;</span><br><span class="line">				clocks = &lt;0x2 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;socpll&quot;;</span><br><span class="line">				phandle = &lt;0x3&gt;;</span><br><span class="line">				linux,phandle = &lt;0x3&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			sata01clk@1f21c000 &#123;</span><br><span class="line">				reg = &lt;0x0 0x1f21c000 0x0 0x1000&gt;;</span><br><span class="line">				csr-offset = &lt;0x4&gt;;</span><br><span class="line">				csr-mask = &lt;0x5&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				enable-offset = &lt;0x0&gt;;</span><br><span class="line">				enable-mask = &lt;0x39&gt;;</span><br><span class="line">				clocks = &lt;0x4 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;sata01clk&quot;;</span><br><span class="line">				phandle = &lt;0xe&gt;;</span><br><span class="line">				linux,phandle = &lt;0xe&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			menetclk &#123;</span><br><span class="line">				reg = &lt;0x0 0x1702c000 0x0 0x1000&gt;;</span><br><span class="line">				#clock-cells = &lt;0x1&gt;;</span><br><span class="line">				reg-names = &quot;csr-reg&quot;;</span><br><span class="line">				compatible = &quot;apm,xgene-device-clock&quot;;</span><br><span class="line">				clock-names = &quot;menetclk&quot;;</span><br><span class="line">				clocks = &lt;0x5 0x0&gt;;</span><br><span class="line">				clock-output-names = &quot;menetclk&quot;;</span><br><span class="line">				phandle = &lt;0x15&gt;;</span><br><span class="line">				linux,phandle = &lt;0x15&gt;;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		rng@10520000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x10520000 0x0 0x100&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x41 0x4&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-rng&quot;;</span><br><span class="line">			clocks = &lt;0x1a 0x0&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		qmtm@17030000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x17030000 0x0 0x10000 0x0 0x10000000 0x0 0x400000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x40 0x4 0x0 0x3c 0x4&gt;;</span><br><span class="line">			#clock-cells = &lt;0x1&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-qmtm-lite&quot;;</span><br><span class="line">			slave-name = &quot;CPU_QMTM3&quot;;</span><br><span class="line">			clocks = &lt;0x14 0x0&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		oldsata@1a000000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1a000000 0x0 0x1000 0x0 0x1f210000 0x0 0x10000&gt;;</span><br><span class="line">			phys = &lt;0xf 0x0&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x86 0x4&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-ahci-sgmii&quot;;</span><br><span class="line">			phy-names = &quot;sata-6g&quot;;</span><br><span class="line">			clocks = &lt;0xe 0x0&gt;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		reboot@17000014 &#123;</span><br><span class="line">			mask = &lt;0x1&gt;;</span><br><span class="line">			compatible = &quot;syscon-reboot&quot;;</span><br><span class="line">			offset = &lt;0x14&gt;;</span><br><span class="line">			regmap = &lt;0x16&gt;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		oldsata@1a400000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1a400000 0x0 0x1000 0x0 0x1f220000 0x0 0x10000&gt;;</span><br><span class="line">			phys = &lt;0x11 0x0&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x87 0x4&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-ahci-sgmii&quot;;</span><br><span class="line">			phy-names = &quot;sata-6g&quot;;</span><br><span class="line">			clocks = &lt;0x10 0x0&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		oldsata@1a800000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1a800000 0x0 0x1000 0x0 0x1f230000 0x0 0x10000&gt;;</span><br><span class="line">			phys = &lt;0x13 0x0&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x88 0x4&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-ahci-pcie&quot;;</span><br><span class="line">			phy-names = &quot;sata-6g&quot;;</span><br><span class="line">			clocks = &lt;0x12 0x0&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		ethernet@17020000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x17020000 0x0 0xd100 0x0 0x17030000 0x0 0xc300 0x0 0x10000000 0x0 0x200&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x3c 0x4&gt;;</span><br><span class="line">			phy-handle = &lt;0x17&gt;;</span><br><span class="line">			reg-names = &quot;enet_csr&quot;, &quot;ring_csr&quot;, &quot;ring_cmd&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene-enet&quot;;</span><br><span class="line">			local-mac-address = [00 01 73 02 0b 73];</span><br><span class="line">			dma-coherent;</span><br><span class="line">			clocks = &lt;0x15 0x0&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			phy-connection-type = &quot;rgmii&quot;;</span><br><span class="line"></span><br><span class="line">			mdio &#123;</span><br><span class="line">				compatible = &quot;apm,xgene-mdio&quot;;</span><br><span class="line">				#address-cells = &lt;0x1&gt;;</span><br><span class="line">				#size-cells = &lt;0x0&gt;;</span><br><span class="line"></span><br><span class="line">				menetphy@3 &#123;</span><br><span class="line">					reg = &lt;0x3&gt;;</span><br><span class="line">					compatible = &quot;ethernet-phy-id001c.c915&quot;;</span><br><span class="line">					phandle = &lt;0x17&gt;;</span><br><span class="line">					linux,phandle = &lt;0x17&gt;;</span><br><span class="line">				&#125;;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		ethernet@1f210000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f210000 0x0 0xd100 0x0 0x1f200000 0x0 0xc300 0x0 0x1b000000 0x0 0x200&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0xa0 0x4 0x0 0xa1 0x4&gt;;</span><br><span class="line">			reg-names = &quot;enet_csr&quot;, &quot;ring_csr&quot;, &quot;ring_cmd&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene1-sgenet&quot;;</span><br><span class="line">			local-mac-address = [00 00 00 00 00 00];</span><br><span class="line">			dma-coherent;</span><br><span class="line">			clocks = &lt;0x18 0x0&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			phy-connection-type = &quot;sgmii&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		ethernet@1f610000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1f610000 0x0 0xd100 0x0 0x1f600000 0x0 0xc300 0x0 0x18000000 0x0 0x200&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x60 0x4 0x0 0x61 0x4&gt;;</span><br><span class="line">			reg-names = &quot;enet_csr&quot;, &quot;ring_csr&quot;, &quot;ring_cmd&quot;;</span><br><span class="line">			compatible = &quot;apm,xgene1-xgenet&quot;;</span><br><span class="line">			local-mac-address = [00 00 00 00 00 00];</span><br><span class="line">			dma-coherent;</span><br><span class="line">			clocks = &lt;0x19 0x0&gt;;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">			phy-connection-type = &quot;xgmii&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		sata@1a000000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1a000000 0x0 0x1000 0x0 0x1f210000 0x0 0x1000 0x0 0x1f21d000 0x0 0x1000 0x0 0x1f21e000 0x0 0x1000 0x0 0x1f217000 0x0 0x1000&gt;;</span><br><span class="line">			phys = &lt;0xf 0x0&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x86 0x4&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-ahci&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			phy-names = &quot;sata-phy&quot;;</span><br><span class="line">			clocks = &lt;0xe 0x0&gt;;</span><br><span class="line">			status = &quot;disabled&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		sata@1a400000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1a400000 0x0 0x1000 0x0 0x1f220000 0x0 0x1000 0x0 0x1f22d000 0x0 0x1000 0x0 0x1f22e000 0x0 0x1000 0x0 0x1f227000 0x0 0x1000&gt;;</span><br><span class="line">			interrupts = &lt;0x0 0x87 0x4&gt;;</span><br><span class="line">			compatible = &quot;apm,xgene-ahci&quot;;</span><br><span class="line">			dma-coherent;</span><br><span class="line">			status = &quot;ok&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	cpus &#123;</span><br><span class="line">		#address-cells = &lt;0x2&gt;;</span><br><span class="line">		#size-cells = &lt;0x0&gt;;</span><br><span class="line"></span><br><span class="line">		cpu@000 &#123;</span><br><span class="line">			reg = &lt;0x0 0x0&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0x8008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		cpu@001 &#123;</span><br><span class="line">			reg = &lt;0x0 0x1&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0x9008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		cpu@100 &#123;</span><br><span class="line">			reg = &lt;0x0 0x100&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0xa008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		cpu@101 &#123;</span><br><span class="line">			reg = &lt;0x0 0x101&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0xb008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		cpu@200 &#123;</span><br><span class="line">			reg = &lt;0x0 0x200&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0xc008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		cpu@201 &#123;</span><br><span class="line">			reg = &lt;0x0 0x201&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0xd008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		cpu@300 &#123;</span><br><span class="line">			reg = &lt;0x0 0x300&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0xe008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		cpu@301 &#123;</span><br><span class="line">			reg = &lt;0x0 0x301&gt;;</span><br><span class="line">			compatible = &quot;apm,potenza&quot;, &quot;arm,armv8&quot;;</span><br><span class="line">			cpu-release-addr = &lt;0x40 0xf008&gt;;</span><br><span class="line">			enable-method = &quot;spin-table&quot;;</span><br><span class="line">			device_type = &quot;cpu&quot;;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	timer &#123;</span><br><span class="line">		interrupts = &lt;0x1 0x0 0xff01 0x1 0xd 0xff01 0x1 0xe 0xff01 0x1 0xf 0xff01&gt;;</span><br><span class="line">		compatible = &quot;arm,armv8-timer&quot;;</span><br><span class="line">		clock-frequency = &lt;0x2faf080&gt;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	aliases &#123;</span><br><span class="line">		ethernet0 = &quot;/soc/ethernet@17020000&quot;;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	interrupt-controller@78010000 &#123;</span><br><span class="line">		reg = &lt;0x0 0x78090000 0x0 0x10000 0x0 0x780a0000 0x0 0x20000 0x0 0x780c0000 0x0 0x10000 0x0 0x780e0000 0x0 0x20000&gt;;</span><br><span class="line">		interrupts = &lt;0x1 0x9 0xf04&gt;;</span><br><span class="line">		compatible = &quot;arm,cortex-a15-gic&quot;;</span><br><span class="line">		#interrupt-cells = &lt;0x3&gt;;</span><br><span class="line">		phandle = &lt;0x1&gt;;</span><br><span class="line">		interrupt-controller;</span><br><span class="line">		linux,phandle = &lt;0x1&gt;;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>使用方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y dtc</span><br><span class="line">dtc -I dts mustang.dts -O dtb -o /boot/mustang.dtb</span><br></pre></td></tr></table></figure>
<p>随后修改/boot/efi/EFI/centos/grub.cfg中修改第一个entry，添加</p>
<p>devicetree /mustang.dtb</p>
<p>并重启即可~</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/08/29/AArch64简介/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/08/29/AArch64简介/" itemprop="url">
                  AArch64简介
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2015-08-29 10:10:44" itemprop="dateCreated datePublished" datetime="2015-08-29T10:10:44+08:00">2015-08-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/aarch64/" itemprop="url" rel="index"><span itemprop="name">aarch64</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/08/29/AArch64简介/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/08/29/AArch64简介/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="about-aarch64"><a href="#about-aarch64" class="headerlink" title="about aarch64"></a>about aarch64</h1><ol>
<li>Focus on high performance </li>
<li>Exception levels instead of different modes</li>
<li>virtualisation support built-in</li>
<li>32 bit fixed length instruction </li>
<li>more registers</li>
<li>divide instruction</li>
<li>compare &amp; jump instruction</li>
<li>support for aarch32</li>
</ol>
<h2 id="difference-towards-aarch32"><a href="#difference-towards-aarch32" class="headerlink" title="difference towards aarch32"></a>difference towards aarch32</h2><ol>
<li>no thumb mode</li>
<li>only a handful conditionally executing instruction</li>
<li>no more coprocessor</li>
<li>beware PC relative addressing doesn’t have an offset anymore</li>
<li>31 general purpose registers.1 special purpose</li>
<li>no store/load multiple registers(only pairs)</li>
</ol>
<h2 id="aarch64-registers"><a href="#aarch64-registers" class="headerlink" title="aarch64 registers"></a>aarch64 registers</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">registers	special	description</span><br><span class="line">SP/ZR				Stack pointor/Zero register</span><br><span class="line">30			LR		Link register</span><br><span class="line">29			FP		Frame pointer</span><br><span class="line">19~28				stored/restored by callee</span><br><span class="line">18					platforem specific register</span><br><span class="line">17					inter procedure call 1</span><br><span class="line">16					inter procedure call 2</span><br><span class="line">9~15				scratch registers</span><br><span class="line">8					indirect result(pointer to sturct)</span><br><span class="line">0~7					parameters &amp; results</span><br></pre></td></tr></table></figure>
<h3 id="registers-can-be-accessed-as-32-64-bit"><a href="#registers-can-be-accessed-as-32-64-bit" class="headerlink" title="registers can be accessed as 32/64 bit"></a>registers can be accessed as 32/64 bit</h3><p>X0~30 for 64 bit<br>W0~30 for 32 bit<br>Also available<br>V0~31,SIMD floating point registers</p>
<h3 id="Modes-AArch32"><a href="#Modes-AArch32" class="headerlink" title="Modes AArch32"></a>Modes AArch32</h3><p>User        Application<br>FIQ            Fast Interrupt<br>IRQ            Interrupt<br>Supervisor     Operating System<br>Abort         Prefetch abort of instructiion/data<br>Undefined    After undefined instruction<br>System        Privileged user mode (for OS functions)<br>Monitor        On TrustZone Platforms</p>
<h3 id="Modes-on-Aarch64"><a href="#Modes-on-Aarch64" class="headerlink" title="Modes on Aarch64"></a>Modes on Aarch64</h3><p>EL0            Unprivileged,applications(with task protection,etc)<br>EL1            Operating system,kernel,etc<br>EL2            Hypervisor(for virtualisation)<br>EL3            Secure monitor(for switching to/from secure state)</p>
<blockquote>
<p>svc,hvc,smc指令切换，对EL1~3有三种不同的中断向量，客户端可以生产virtual exceptions</p>
</blockquote>
<p><em>CP15 is no more</em></p>
<blockquote>
<p>Cache,address and TLB management now have dedicated instructions</p>
</blockquote>
<blockquote>
<p>Memory management</p>
</blockquote>
<blockquote>
<p>Execpt for EL0,all exception levels have their own memory translation </p>
</blockquote>
<blockquote>
<p>context(EL0 is managed by EL1)</p>
</blockquote>
<blockquote>
<p>This means up to 3 stage translation depending on the context</p>
</blockquote>
<h2 id="UEFI-amp-ACPI"><a href="#UEFI-amp-ACPI" class="headerlink" title="UEFI&amp;ACPI"></a>UEFI&amp;ACPI</h2><p><a href="http://www.uefi.org/sites/default/files/resources/S4_BldgARMServers_UEFILinuxCon_FINAL_Aug.%2021.pdf" target="_blank" rel="noopener">http://www.uefi.org/sites/default/files/resources/S4_BldgARMServers_UEFILinuxCon_FINAL_Aug.%2021.pdf</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/07/19/Fedora22-for-arndale-octa-board/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/19/Fedora22-for-arndale-octa-board/" itemprop="url">
                  Fedora22 image for arndale octa board
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2015-07-19 12:03:00" itemprop="dateCreated datePublished" datetime="2015-07-19T12:03:00+08:00">2015-07-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/07/19/Fedora22-for-arndale-octa-board/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/07/19/Fedora22-for-arndale-octa-board/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Hello,everynoe.</p>
<p>I have made an image based Fedora 22 for arndale octa board.</p>
<p>Offical arndale octa board just provides the linaro ubuntu linux release , but i’m more familiar RHEL/Fedora/CentOS series,,so i take some time to port the fedora 22 to this board, and it works very good.</p>
<p>The image file is very easy to use,and supposes that you use the linux/mac osx ,you just insert your tf card, open the terminal and input follow commands:</p>
<p><code>dd if=Fedora22-arndale-octa-1G.img of=/dev/sdX bs=1M</code></p>
<p>when it dones,poll out the tf card and insert it to the board,boot it and it will work ok .Maybe you should upgrade the kernel and dtb files because the new 4.1-rc8 kernel is more efficient and good.please command follow:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/mmcblk1p2 /media</span><br><span class="line">cp uImage /media/</span><br><span class="line">cp board.dtb /media/</span><br></pre></td></tr></table></figure>
<p>Besides:</p>
<ol>
<li><a href="https://pan.baidu.com/s/1o6215xg" target="_blank" rel="noopener">Fedora22-arndale-octa-1G.img</a> </li>
<li><a href="https://pan.baidu.com/s/1jG1U3tW" target="_blank" rel="noopener">uImage</a></li>
<li><a href="https://pan.baidu.com/s/1jGAHWX4" target="_blank" rel="noopener">board.dtb</a></li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/04/08/为Fedora21-aarch64制作RPM包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/04/08/为Fedora21-aarch64制作RPM包/" itemprop="url">
                  为Fedora21 aarch64制作RPM包（tengine） 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2015-04-08 10:45:00" itemprop="dateCreated datePublished" datetime="2015-04-08T10:45:00+08:00">2015-04-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/aarch64/" itemprop="url" rel="index"><span itemprop="name">aarch64</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/04/08/为Fedora21-aarch64制作RPM包/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/04/08/为Fedora21-aarch64制作RPM包/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文简单记录将tengine-2.10版本源码打为rpm包的步骤，此处是简单的封装了下二进制，没有做复杂的脚本配置和gpg校验等，待以后有时间继续研究。<br>1.安装必要包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$yum install -y gcc pcre-devel openssl-devel</span><br></pre></td></tr></table></figure></p>
<p>2.创建tengine rpm构建目录，使用非root用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$su - jefby</span><br><span class="line">$mkdir -p tengine_rpm/&#123;BUILD,RPMS,SOURCES,SPECS,SRPMS&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.编写spec文件，将源码放置到SOURCES目录下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$unzip tengine-master.zip</span><br><span class="line">$mv tengine-master tengine-2.10</span><br><span class="line">$tar -cjvf tengine-2.10.tar.bz2 tengine-2.10</span><br><span class="line">$mv tengine-2.10.tar.bz2 SOURCES</span><br><span class="line">$vi SPECS/tengine.spec</span><br></pre></td></tr></table></figure></p>
<p>tengine.spec文件详细内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># This is a sample spec file for tengine</span><br><span class="line"></span><br><span class="line">%define _topdir         /home/jefby/tengine_rpm</span><br><span class="line">%define name            tengine</span><br><span class="line">%define release         2</span><br><span class="line">%define version         2.10</span><br><span class="line">%define buildroot       %&#123;_topdir&#125;/%&#123;name&#125;-%&#123;version&#125;-root</span><br><span class="line"></span><br><span class="line">BuildRoot:              %&#123;buildroot&#125;</span><br><span class="line">Summary:                TAOBAO Tengine</span><br><span class="line">License:                GPL</span><br><span class="line">Name:                   %&#123;name&#125;</span><br><span class="line">Version:                %&#123;version&#125;</span><br><span class="line">Release:                %&#123;release&#125;</span><br><span class="line">Source:                 %&#123;name&#125;-%&#123;version&#125;.tar.bz2</span><br><span class="line">Prefix:                 /usr/local</span><br><span class="line">Group:                  Development/Tools</span><br><span class="line">BuildRequires:          gcc,make</span><br><span class="line">Requires:               pcre,pcre-devel,openssl,openssl-devel,chkconfig &gt;= 1.1.1</span><br><span class="line"></span><br><span class="line">%description</span><br><span class="line">Tengine is the webserver based nginx for taobao website</span><br><span class="line"></span><br><span class="line">%prep #编译前准备，主要是解压缩源码，并进入压缩后的目录</span><br><span class="line">%setup -q</span><br><span class="line"></span><br><span class="line">%build #编译</span><br><span class="line">./configure --prefix=/opt/nginx</span><br><span class="line">make %&#123;?_smp_mflags&#125; #检查处理器核心数目，若为多核则使用多核编译</span><br><span class="line"></span><br><span class="line">%install #安装，如果不设置DESTDIR，默认安装到prefix指定的目录</span><br><span class="line">rm -rf %&#123;buildroot&#125;</span><br><span class="line">make install DESTDIR=%&#123;buildroot&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#%post  #rpm安装后执行的脚本</span><br><span class="line"></span><br><span class="line">#%preun #卸载前执行的脚本</span><br><span class="line"></span><br><span class="line">#%postun #卸载后执行的脚本</span><br><span class="line"></span><br><span class="line">%clean #清理，检查buildroot是否为根目录，如果不是直接删除</span><br><span class="line">[ %&#123;buildroot&#125; != &apos;/&apos; ] &amp;&amp; rm -rf %&#123;buildroot&#125;</span><br><span class="line"></span><br><span class="line">%files #打包到rpm的文件，因为prefix指定为/opt/nginx，此时将整个文件夹打包</span><br><span class="line">/opt/nginx</span><br><span class="line">%defattr(-,root,root)#设置属性</span><br></pre></td></tr></table></figure></p>
<p>目录结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$tree .</span><br><span class="line">├── BUILD</span><br><span class="line">├── RPMS</span><br><span class="line">├── SOURCES</span><br><span class="line">│   └── tengine-2.10.tar.bz2</span><br><span class="line">├── SPECS</span><br><span class="line">│   └── tengine.spec</span><br><span class="line">└── SRPMS</span><br></pre></td></tr></table></figure></p>
<p>说明：<br>    BUILD    源代码解压后的存放目录<br>    RPMS    制作完成后的RPM包存放目录，里面有与平台相关的子目录<br>    SOURCES 软件源码及补丁<br>    SPECS   SPEC文件存放目录<br>    SRMPS   存放SRMPS生成的目录<br>4.编译制作rpm包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$rpmbuild -v -ba --clean SPEC/tengine.spec</span><br><span class="line">其中-v表示Verbose，输出详细信息</span><br><span class="line">-bb：构建二进制RPM包</span><br><span class="line">-ba：构建二进制RPM和源码src.RPM包</span><br><span class="line">-bp：运行到pre结束</span><br><span class="line">-bc：执行到build结束</span><br><span class="line">-bi：运行到install结束</span><br><span class="line">-bl：检查有文件没包含</span><br><span class="line">一般使用bb或者ba</span><br><span class="line">--clean：</span><br><span class="line">Remove the build tree after the packages are made.</span><br></pre></td></tr></table></figure></p>
<p>成功会在RPMS目录下生成<br>tengine-xxx.rpm和tengine-debuginfo-xxx.rpm包，在SRPMS目录下生成src.rpm包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">├── BUILD</span><br><span class="line">├── RPMS</span><br><span class="line">│   └── aarch64</span><br><span class="line">│       ├── tengine-2.10-2.aarch64.rpm</span><br><span class="line">│       └── tengine-debuginfo-2.10-2.aarch64.rpm</span><br><span class="line">├── SOURCES</span><br><span class="line">│   └── tengine-2.10.tar.bz2</span><br><span class="line">├── SPECS</span><br><span class="line">│   └── tengine.spec</span><br><span class="line">└── SRPMS</span><br><span class="line">    └── tengine-2.10-2.src.rpm</span><br></pre></td></tr></table></figure></p>
<p>如此，RPM便制作OK，可以添加到私有repo中(暂时关闭掉gpg校验)，或者直接使用rpm方式安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$rpm -ivh tengine-2-10-2.aarch64.rpm</span><br></pre></td></tr></table></figure></p>
<p> 补充：<br> 查看spec文件已定义的一些宏，可以搜索文件<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$cat /usr/lib/rpm/macro</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/04/06/在PC-Linux下运行Qemu模拟AArch64硬件调试内核/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/04/06/在PC-Linux下运行Qemu模拟AArch64硬件调试内核/" itemprop="url">
                  在PC-Linux下运行Qemu模拟AArch64硬件调试内核
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2015-04-06 13:28:22" itemprop="dateCreated datePublished" datetime="2015-04-06T13:28:22+08:00">2015-04-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/aarch64/" itemprop="url" rel="index"><span itemprop="name">aarch64</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/04/06/在PC-Linux下运行Qemu模拟AArch64硬件调试内核/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/04/06/在PC-Linux下运行Qemu模拟AArch64硬件调试内核/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考链接：<br><a href="http://www.bennee.com/~alex/blog/2014/05/09/running-linux-in-qemus-aarch64-system-emulation-mode/" target="_blank" rel="noopener">http://www.bennee.com/~alex/blog/2014/05/09/running-linux-in-qemus-aarch64-system-emulation-mode/</a></p>
<p>环境说明：<br>Fedora21 x86_64</p>
<p>ARM公司推出ARM V8架构后，全面进入64位CPU时代，可是目前市场上出现的设备太少或者说性价比不高，但是又想做相关平台下的开发，那么可以考虑下使用qemu模拟器</p>
<p>安装aarch64-qemu：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo yum install -y qemu-system-aarch64</span><br></pre></td></tr></table></figure>
<p>如果想快速使用模型，可以下载这个镜像：<br><a href="http://people.linaro.org/~alex.bennee/images/aarch64-linux-3.15rc2-buildroot.img" target="_blank" rel="noopener">http://people.linaro.org/~alex.bennee/images/aarch64-linux-3.15rc2-buildroot.img</a><br>然后运行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$qemu-system-aarch64 -machine virt -cpu cortex-a57 -machine type=virt -nographic -smp 1 -m 2048 -kernel aarch64-linux-3.15rc2-buildroot.img  --append &quot;console=ttyAMA0&quot;</span><br></pre></td></tr></table></figure>
<p>输入root，免密码登陆：<br><img src="http://img.blog.csdn.net/20150406124814496" alt="查看配置"><br>当然还可能需要使用qemu来调试Linux内核，那么需要使用buildroot来构建根文件系统，然后再次配置编译内核，最后启动gdb连接到gdbserver上来进行内核调试和分析：<br>1.下载和编译buildroot<br>(1)下载buildroot，2015-02稳定版<br><a href="http://buildroot.uclibc.org/download.html" target="_blank" rel="noopener">http://buildroot.uclibc.org/download.html</a><br>(2)配置和编译</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$tar -xjvf buildroot-2015.02.tar.bz2</span><br><span class="line">$cd buildroot-2015.02</span><br><span class="line">$make menuconfig</span><br></pre></td></tr></table></figure>
<p>选用externel cross-compiler，Linaro 14.09，选择安装路径，然后到Linaro官网下载对应的编译器，不要使用yum来安装对应的编译器，因为红帽公司打包的交叉编译器缺少kernel头文件，我把我的配置文件放到了百度网盘，可以参考：<br><a href="http://pan.baidu.com/s/176ef0" target="_blank" rel="noopener">http://pan.baidu.com/s/176ef0</a><br>Linaro 14.09交叉编译器的链接地址：<br><a href="https://releases.linaro.org/14.09/components/toolchain/binaries" target="_blank" rel="noopener">https://releases.linaro.org/14.09/components/toolchain/binaries</a><br>下载gcc-linaro-aarch64-linux-gnu-4.9-2014.09_linux.tar.bz2，解压缩到目录/opt/，修改名称并再buildroot中配置路径，然后编译，顺利的话会在目录output/images/生成rootfs.cpio文件，即为根文件系统。<br>(3)下载并配置编译内核<br>到kernel.org下载最新版内核，配置initramfs使用buildroot生成的根文件系统，配置架构和交叉工具，编译</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ARCH=arm64 make menuconfig</span><br><span class="line">$ARCH=arm64 make -j 8</span><br></pre></td></tr></table></figure>
<p>参考配置文件：<br><a href="http://pan.baidu.com/s/1i35pWwP" target="_blank" rel="noopener">http://pan.baidu.com/s/1i35pWwP</a><br>成功会在arch/arm64/boot/目录生成Image文件，然后使用以下命令启动：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$qemu-system-aarch64 -machine virt -cpu cortex-a57 -machine type=virt -nographic -smp 1 -m 2048 -kernel /home/jefby/linux-3.19.3/arch/arm64/boot/Image  --append &quot;console=ttyAMA0&quot;</span><br></pre></td></tr></table></figure>
<p>(4)调试内核</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$  qemu-system-aarch64 -s -S -machine virt -cpu cortex-a57 -machine type=virt -nographic -smp 1 -m 2048 -kernel /home/jefby/linux-3.19.3/arch/arm64/boot/Image  --append &quot;console=ttyAMA0&quot;</span><br></pre></td></tr></table></figure>
<p>此时内核启动，并使用gdbserver打开了1234端口供gdb客户端连接，本地打开terminal，输入以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$cd linux-3.19.3</span><br><span class="line">$aarch64-linux-gnu-gdb</span><br><span class="line">$file vmlinux</span><br><span class="line">$target remote localhost:1234</span><br><span class="line">$b start_kernel</span><br><span class="line">$c</span><br><span class="line">$n</span><br></pre></td></tr></table></figure>
<p>如图所示：<br><img src="http://img.blog.csdn.net/20150406132804121" alt="这里写图片描述"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/03/25/tftpd服务启动失败问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/03/25/tftpd服务启动失败问题/" itemprop="url">
                  dnsmasq TFTP directory /tftpd inaccessible: Permission denied
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2015-03-25 17:24:47" itemprop="dateCreated datePublished" datetime="2015-03-25T17:24:47+08:00">2015-03-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/03/25/tftpd服务启动失败问题/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/03/25/tftpd服务启动失败问题/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>调试pxe的时候碰到了如下问题”dnsmasq TFTP directory /tftpd inaccessible: Permission denied”，记录下解决步骤:</p>
<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>在fedora21 server版本中配置dnsmasq作为tftp服务器，修改配置文件/etc/dnsmasq.conf，增加如下选项：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enable-tftp</span><br><span class="line">tftp-root=/tftpd</span><br></pre></td></tr></table></figure>
<p>在根目录下创建文件夹tftpd，修改属主为nobody:nobody，然后启动dnsmasq服务器，总是不能启动起来，错误信息如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mar 25 16:54:35 localhost dnsmasq[1787]: TFTP directory /tftpd inaccessible: Permission denied</span><br><span class="line">Mar 25 16:54:35 localhost dnsmasq[1787]: FAILED to start up</span><br><span class="line">Mar 25 16:54:35 localhost systemd: dnsmasq.service: main process exited, code=exited, status=3/NOTIMPLEMENTED</span><br><span class="line">Mar 25 16:54:35 localhost systemd: Unit dnsmasq.service entered failed state.</span><br><span class="line">Mar 25 16:54:35 localhost systemd: dnsmasq.service failed.</span><br></pre></td></tr></table></figure>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>刚开始以为是tftpd文件夹的权限问题，就将它设置为777，重启仍然报错，最后思考了下会不会是SELinux所致，默认fedora安装完成后SELINUX的状态为enforcing，关闭SELINUX，重启OK，还真是这个原因！！！建议默认情况下关闭SELinux，方法有两种：</p>
<ul>
<li>暂时关闭</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0</span><br></pre></td></tr></table></figure>
<ul>
<li>永久关闭</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/selinux/config修改enforcing为disable，重启服务器</span><br></pre></td></tr></table></figure>
<p>dnsmasq启动OK的输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Mar 25 17:09:12 localhost dnsmasq[2131]: started, version 2.72 cachesize 150</span><br><span class="line">Mar 25 17:09:12 localhost dnsmasq[2131]: compile time options: IPv6 GNU-getopt DBus no-i18n IDN DHCP DHCPv6 no-Lua TFTP no-conntrack ipset auth DNSSEC loop-detect</span><br><span class="line">Mar 25 17:09:12 localhost dnsmasq-dhcp[2131]: DHCP, IP range 192.168.0.50 -- 192.168.0.150, lease time 12h</span><br><span class="line">Mar 25 17:09:12 localhost dnsmasq-tftp[2131]: TFTP root is /tftpd</span><br><span class="line">Mar 25 17:09:12 localhost dnsmasq[2131]: reading /etc/resolv.conf</span><br><span class="line">Mar 25 17:09:12 localhost dnsmasq[2131]: read /etc/hosts - 2 addresses</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/09/21/Linux用户空间和内核空间通信方式比较/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/21/Linux用户空间和内核空间通信方式比较/" itemprop="url">
                  Linux用户空间和内核空间通信方式比较
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-21 06:46:22" itemprop="dateCreated datePublished" datetime="2014-09-21T06:46:22+08:00">2014-09-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/09/21/Linux用户空间和内核空间通信方式比较/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/09/21/Linux用户空间和内核空间通信方式比较/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>资料整理：</p>
<ol>
<li><p>论文，主要比较通信方式<br><a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=5696027" target="_blank" rel="noopener">http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=5696027</a></p>
</li>
<li><p>stackoverflow部分讨论</p>
</li>
</ol>
<p><a href="http://stackoverflow.com/questions/8145943/communication-between-linux-kernel-and-user-space-program" target="_blank" rel="noopener">http://stackoverflow.com/questions/8145943/communication-between-linux-kernel-and-user-space-program</a></p>
<ol start="3">
<li>论文，主要讨论netlink</li>
</ol>
<p><a href="http://1984.lsi.us.es/~pablo/docs/spae.pdf" target="_blank" rel="noopener">http://1984.lsi.us.es/~pablo/docs/spae.pdf</a></p>
<ol start="4">
<li>介绍netlink的一篇博文，写的不错！</li>
</ol>
<p><a href="http://www.cnblogs.com/iceocean/articles/1594195.html" target="_blank" rel="noopener">http://www.cnblogs.com/iceocean/articles/1594195.html</a></p>
<p>摘抄自4的博文：</p>
<p>netlink 相对于系统调用，ioctl 以及 /proc 文件系统而言具有以下优点：</p>
<p>1，为了使用 netlink，用户仅需要在 include/linux/netlink.h 中增加一个新类型的 netlink 协议定义即可， 如 #define NETLINK_MYTEST 17 然后，内核和用户态应用就可以立即通过 socket API 使用该 netlink 协议类型进行数据交换。但系统调用需要增加新的系统调用，ioctl 则需要增加设备或文件，那需要不少代码，proc 文件系统则需要在/proc下添加新的文件或目录，那将使本来就混乱的 /proc 更加混乱。</p>
<ol start="2">
<li>netlink是一种异步通信机制，在内核与用户态应用之间传递的消息保存在socket缓存队列中，发送消息只是把消息保存在接收者的socket的接收队列，而不需要等待接收者收到消息，但系统调用与 ioctl 则是同步通信机制，如果传递的数据太长，将影响调度粒度。</li>
</ol>
<p>3．使用 netlink 的内核部分可以采用模块的方式实现，使用 netlink 的应用部分和内核部分没有编译时依赖，但系统调用就有依赖，而且新的系统调用的实现必须静态地连接到内核中，它无法在模块中实现，使用新系统调用的应用在编译时需要依赖内核。</p>
<p>4．netlink支持多播，内核模块或应用可以把消息多播给一个netlink组，属于该neilink 组的任何内核模块或应用都能接收到该消息，内核事件向用户态的通知机制就使用了这一特性，任何对内核事件感兴趣的应用都能收到该子系统发送的内核事件，在 后面的文章中将介绍这一机制的使用。</p>
<p>5．内核可以使用 netlink 首先发起会话，但系统调用和 ioctl 只能由用户应用发起调用。</p>
<p>6．netlink 使用标准的 socket API，因此很容易使用，但系统调用和 ioctl则需要专门的培训才能使用。</p>
<pre><code>jefby
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/25/arm-linux内核源码中关于何时开启MMU的思考/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/25/arm-linux内核源码中关于何时开启MMU的思考/" itemprop="url">
                  arm linux内核源码中关于何时开启MMU的思考
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-25 06:00:53" itemprop="dateCreated datePublished" datetime="2014-08-25T06:00:53+08:00">2014-08-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/aarch64/" itemprop="url" rel="index"><span itemprop="name">aarch64</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/25/arm-linux内核源码中关于何时开启MMU的思考/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/25/arm-linux内核源码中关于何时开启MMU的思考/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天再次阅读arm linux内核源码，看MMU启动部分发现了一个问题，就是在常规的<strong>enable_mmu和</strong>turn_mmu_on部分我没有找到真正使能MMU标志的代码，但是它到底是什么时候将MMU的最低位置1的呢？？怀着这个疑问我在google上搜索了好多，但是对于这个问题的解答都是模凌两可，说的特别含糊，千篇一律，不能让人信服。</p>
<p>__enable_mmu代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">__enable_mmu:</span><br><span class="line"></span><br><span class="line">#if defined(CONFIG_ALIGNMENT_TRAP) &amp;&amp; __LINUX_ARM_ARCH__ &lt; 6</span><br><span class="line"></span><br><span class="line">orr r0, r0, #CR_A</span><br><span class="line"></span><br><span class="line">#else</span><br><span class="line"></span><br><span class="line">bic r0, r0, #CR_A</span><br><span class="line"></span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">#ifdef CONFIG_CPU_DCACHE_DISABLE</span><br><span class="line"></span><br><span class="line">bic r0, r0, #CR_C</span><br><span class="line"></span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">#ifdef CONFIG_CPU_BPREDICT_DISABLE</span><br><span class="line"></span><br><span class="line">bic r0, r0, #CR_Z</span><br><span class="line"></span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">#ifdef CONFIG_CPU_ICACHE_DISABLE</span><br><span class="line"></span><br><span class="line">bic r0, r0, #CR_I</span><br><span class="line"></span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">#ifndef CONFIG_ARM_LPAE</span><br><span class="line"></span><br><span class="line">mov r5, #(domain_val(DOMAIN_USER, DOMAIN_MANAGER) | \</span><br><span class="line"></span><br><span class="line">domain_val(DOMAIN_KERNEL, DOMAIN_MANAGER) | \</span><br><span class="line"></span><br><span class="line">domain_val(DOMAIN_TABLE, DOMAIN_MANAGER) | \</span><br><span class="line"></span><br><span class="line">domain_val(DOMAIN_IO, DOMAIN_CLIENT))</span><br><span class="line"></span><br><span class="line">mcr p15, 0, r5, c3, c0, 0 @ load domain access register</span><br><span class="line"></span><br><span class="line">mcr p15, 0, r4, c2, c0, 0 @ load page table pointer</span><br><span class="line"></span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">b __turn_mmu_on</span><br><span class="line"></span><br><span class="line">ENDPROC(__enable_mmu)</span><br></pre></td></tr></table></figure>
<p>__turn_mmu_on源码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ENTRY(__turn_mmu_on)</span><br><span class="line"></span><br><span class="line">mov r0, r0</span><br><span class="line"></span><br><span class="line">instr_sync</span><br><span class="line"></span><br><span class="line">mcr p15, 0, r0, c1, c0, 0 @ write control reg(启用MMU)</span><br><span class="line"></span><br><span class="line">mrc p15, 0, r3, c0, c0, 0 @ read id reg</span><br><span class="line"></span><br><span class="line">instr_sync</span><br><span class="line"></span><br><span class="line">mov r3, r3</span><br><span class="line"></span><br><span class="line">mov r3, r13 @r3中转入最后要跳入的虚拟地址</span><br><span class="line"></span><br><span class="line">mov pc, r3 @跳转到__mmap_switched</span><br><span class="line"></span><br><span class="line">__turn_mmu_on_end:</span><br></pre></td></tr></table></figure>
<p>在<strong>turn_mmu_on中将r0的值写入协处理CP15的C1寄存器中，但是r0的bit0什么时候被置位了呢？？</strong>enable_mmu没有置位，那就肯定是在__enable_mmu之前，搜索代码找到了答案：</p>
<p>::arch/arm/mm/proc-v6.S</p>
<p>其实在__v6_setup中设置的，有一段代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adr r5,v6_crval @将v6_crval的实际运行地址加载到r5处</span><br><span class="line">ldmia r5,&#123;r5,r6&#125;@将r5地址处的两个字内容保存到r5和r6处，根据v6_crval定义可知，值为clear和mmuset，mmmuset的最后一个比特值为1，也就是CR_M=1</span><br><span class="line">orr r0,r0,r6 @在此处将设置r0的bit0为1。随后在__turn_mmu_on中将MMU的值写入CP15的C1寄存器，真正使能MMU。</span><br></pre></td></tr></table></figure>
<p>v6_crval的定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.type v6_crval, #object</span><br><span class="line"></span><br><span class="line">v6_crval: crval clear=0x01e0fb7f, mmuset=0x00c0387d, ucset=0x00c0187c</span><br></pre></td></tr></table></figure>
<p>其中crval是定义的宏，根据配置CONFIG_MMU不同存放不同的值.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.macro crval, clear, mmuset, ucset</span><br><span class="line"></span><br><span class="line">#ifdef CONFIG_MMU</span><br><span class="line"></span><br><span class="line"> .word \clear</span><br><span class="line"> .word \mmuset</span><br><span class="line"></span><br><span class="line">#else</span><br><span class="line"></span><br><span class="line"> .word \clear</span><br><span class="line"> .word \ucset</span><br><span class="line"></span><br><span class="line">#endif                                                                                                         .endm</span><br></pre></td></tr></table></figure>
<p>至此就非常清楚了，在<strong>v6_setup中设置了r0的bit0，然后调用</strong>enable_mmu和__turn_mmu_on真正开启MMU。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/05/23/wndr3800实现USB设备自动挂载/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jefby">
      <meta itemprop="description" content="记录点点滴滴">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jefby的小窝">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/05/23/wndr3800实现USB设备自动挂载/" itemprop="url">
                  wndr3800 实现USB设备自动挂载
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-05-23 13:03:53" itemprop="dateCreated datePublished" datetime="2014-05-23T13:03:53+08:00">2014-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-25 20:21:20" itemprop="dateModified" datetime="2018-11-25T20:21:20+08:00">2018-11-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/05/23/wndr3800实现USB设备自动挂载/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/05/23/wndr3800实现USB设备自动挂载/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>WNDR3800路由器有USB2.0接口，但是插上USB存储设备后，并没有像在Linux下那样，在/dev目录下有诸如sda,sdb等设备名，所以也不能提供设备访问。那么需要重新编译内核以支持设备的自动探测和对NTFS，EXT4分区的支持。具体步骤如下：</p>
<p>进入trunk目录下，运行make menuconfig配置内核：<br><a href="https://imgchr.com/i/PhJUKO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/19/PhJUKO.md.png" alt="PhJUKO.md.png"></a></p>
<ul>
<li>配置BASE System =&gt; block mount选项，选中</li>
<li>配置Kernel Modules =&gt; Block Devices =&gt; kmod-scsi-generic</li>
<li><p>配置对文件系统的支持,NTFS（windows下常用）和EXT4（Linux下用）</p>
<p>Kernel Modules =&gt; File System =&gt; kmod-fs-ext4<br>NTFS支持，需要安装软件包ntfs-3g<br>配置 Utilities=&gt; Filesystem =&gt;ntfs-3g</p>
</li>
<li><p>保存退出，重新编译内核，并烧写系统到路由器中，使用ssh连接到路由器上，再次插入U盘，可以看到内核提示信息，然后使用mount命令挂载：</p>
</li>
<li><p>测试对NTFS分区的支持<br>同样插入一个格式为NTFS分区的U盘或者移动硬盘<br><a href="https://imgchr.com/i/PhJdqe" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/19/PhJdqe.md.png" alt="PhJdqe.md.png"></a></p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">jefby</p>
              <p class="site-description motion-element" itemprop="description">记录点点滴滴</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">28</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/jefby/" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/jefby_plus" target="_blank" title="Twitter"><i class="fa fa-fw fa-Twitter"></i>Twitter</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jefby</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Muse</a> v6.4.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  

  
    <script id="dsq-count-scr" src="https://jefby-github-io.disqus.com/count.js" async></script>
  

  












  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
